<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VoiceTransformer Pro</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f8f8f8;
      color: #333;
    }
    header {
      text-align: center;
      background-color: #4CAF50;
      color: white;
      padding: 20px;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      padding: 20px;
    }
    section {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin: 10px;
      padding: 20px;
      flex: 1 1 400px;
      max-width: 600px;
      transition: transform 0.2s ease;
    }
    section:hover {
      transform: scale(1.02);
    }
    input[type="text"], textarea, select {
      width: 100%;
      padding: 8px;
      margin: 6px 0;
      box-sizing: border-box;
      border-radius: 6px;
      border: 1px solid #ccc;
      background-color: #f0f0f0;
    }
    textarea:focus, select:focus {
      outline: none;
      border-color: #4CAF50;
    }
    button {
      padding: 10px 20px;
      margin: 5px 2px;
      font-size: 1em;
      cursor: pointer;
      background-color: #4CAF50;
      border: none;
      color: white;
      border-radius: 6px;
      transition: background 0.3s ease;
    }
    button:hover {
      background-color: #45a049;
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    footer {
      text-align: center;
      padding: 10px;
      background-color: #eee;
      font-size: 0.9em;
    }
    .goog-logo-link,
    .goog-te-gadget span {
      display: none !important;
    }
    #google_translate_element {
      color: white;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <header>
    <h1>VoiceTransformer Pro</h1>
    <div id="google_translate_element"></div>
  </header>
  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
    }
  </script>
  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

  <div class="container">
    <section id="tts-section">
      <h2>Text-to-Speech</h2>
      <p>Enter text below, choose options, and click <strong>Speak</strong>.</p>
      <label for="tts-input">Text:</label>
      <textarea id="tts-input" rows="4" placeholder="Type something to speak..."></textarea>

      <label for="languageSelect">Filter by Language:</label>
      <select id="languageSelect"><option value="all">All Languages</option></select>

      <label for="voiceSelect">Voice:</label>
      <select id="voiceSelect"></select>

      <label for="voiceStyle">Voice Style:</label>
      <select id="voiceStyle">
        <option value="default">Default</option>
        <option value="robot">Robot</option>
        <option value="alien">Alien</option>
        <option value="baby">Baby</option>
        <option value="female">Female</option>
        <option value="girl">Girl</option>
        <option value="boy">Boy</option>
        <option value="oldman">Old Man</option>
      </select>

      <div>
        <button id="speakBtn">Speak</button>
        <button id="muteBtn">Mute</button>
        <button id="downloadBtn">Speak &amp; Download MP3</button>
      </div>
    </section>

    <section id="stt-section">
      <h2>Speech-to-Text</h2>
      <p>Click <strong>Start Recording</strong> and speak; transcription will appear below.</p>
      <button id="recordBtn">Start Recording</button>
      <button id="stopBtn" disabled>Stop Recording</button>
      <div id="transcript" style="margin-top:10px; border:1px solid #ccc; padding:10px; min-height:50px;"></div>
    </section>
  </div>

  <footer>Â© 2025 VoiceTransformer Pro. All rights reserved.</footer>

  <script>
    const synth = window.speechSynthesis;
    let voices = [];

    function loadVoices() {
      voices = synth.getVoices();
      const languageSelect = document.getElementById("languageSelect");
      const currentLang = languageSelect.value;
      languageSelect.innerHTML = '<option value="all">All Languages</option>';
      const langSet = new Set();
      voices.forEach(voice => langSet.add(voice.lang));
      Array.from(langSet).sort().forEach(lang => {
        const opt = document.createElement("option");
        opt.value = lang;
        opt.textContent = lang;
        languageSelect.appendChild(opt);
      });
      if (currentLang) languageSelect.value = currentLang;
      populateVoiceList();
    }

    function populateVoiceList() {
      const voiceSelect = document.getElementById("voiceSelect");
      const selectedLang = document.getElementById("languageSelect").value;
      voiceSelect.innerHTML = '';
      voices.forEach((voice, index) => {
        if (selectedLang === 'all' || voice.lang === selectedLang) {
          const option = document.createElement("option");
          option.value = index;
          option.textContent = `${voice.name} (${voice.lang})`;
          voiceSelect.appendChild(option);
        }
      });
    }

    synth.onvoiceschanged = loadVoices;
    loadVoices();

    document.getElementById("speakBtn").addEventListener("click", () => {
      const text = document.getElementById("tts-input").value;
      if (!text || isMuted) return;
      const utterThis = new SpeechSynthesisUtterance(text);
      const selectedIndex = document.getElementById("voiceSelect").value;
      utterThis.voice = voices[selectedIndex];
      const style = document.getElementById("voiceStyle").value;
      switch (style) {
        case "robot": utterThis.pitch = 1.0; utterThis.rate = 0.8; break;
        case "alien": utterThis.pitch = 1.5; utterThis.rate = 1.2; break;
        case "baby": utterThis.pitch = 2.0; utterThis.rate = 0.6; break;
        case "female": utterThis.pitch = 1.4; utterThis.rate = 1.0; break;
        case "girl": utterThis.pitch = 2.0; utterThis.rate = 1.1; break;
        case "boy": utterThis.pitch = 1.3; utterThis.rate = 1.1; break;
        case "oldman": utterThis.pitch = 0.6; utterThis.rate = 0.9; break;
        default: utterThis.pitch = 1.0; utterThis.rate = 1.0;
      }
      synth.speak(utterThis);
    });

    let isMuted = false;
    document.getElementById("muteBtn").addEventListener("click", () => {
      synth.cancel();
      isMuted = !isMuted;
      document.getElementById("muteBtn").textContent = isMuted ? "Unmute" : "Mute";
    });

    document.getElementById("downloadBtn").addEventListener("click", () => {
      const text = document.getElementById("tts-input").value;
      if (!text) return;
      alert("Browser cannot directly download MP3. Please use screen recording or server-based TTS.");
      const utterance = new SpeechSynthesisUtterance(text);
      const selectedIndex = document.getElementById("voiceSelect").value;
      utterance.voice = voices[selectedIndex];
      utterance.pitch = 1.0; utterance.rate = 1.0;
      synth.speak(utterance);
    });

    const recordBtn = document.getElementById("recordBtn");
    const stopBtn = document.getElementById("stopBtn");
    const transcriptDiv = document.getElementById("transcript");
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if (SpeechRecognition) {
      const recognition = new SpeechRecognition();
      recognition.continuous = false;
      recognition.interimResults = false;
      recognition.lang = "en-US";

      recognition.onresult = (event) => {
        const transcript = Array.from(event.results)
          .map(result => result[0].transcript)
          .join("");
        transcriptDiv.textContent = transcript;
      };

      recognition.onerror = (event) => {
        console.error("Speech recognition error:", event.error);
        transcriptDiv.textContent = "Error: " + event.error;
      };

      let isRecording = false;
      recordBtn.addEventListener("click", () => {
        if (!isRecording) {
          recognition.start();
          recordBtn.textContent = "Stop Recording";
          stopBtn.disabled = false;
        } else {
          recognition.stop();
        }
        isRecording = !isRecording;
      });

      stopBtn.addEventListener("click", () => {
        if (isRecording) {
          recognition.stop();
          recordBtn.textContent = "Start Recording";
          isRecording = false;
        }
      });
    } else {
      transcriptDiv.textContent = "Web Speech API not supported in this browser.";
      recordBtn.disabled = true;
    }
  </script>
</body>
</html>
